# Task 2.2: Reading History Sync

**Status:** pending  
**Phase:** 2 - Sync & Analytics  
**Depends on:** Task 1.7  
**Estimated Time:** 30 minutes

## Goal

Sync reading session history to web dashboard.

## Steps

### 1. Database Table
```sql
CREATE TABLE reading_sessions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES profiles(id),
  url TEXT,
  title TEXT,
  words_read INT,
  total_words INT,
  average_wpm INT,
  duration_ms INT,
  completed_at TIMESTAMP DEFAULT NOW(),
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_reading_sessions_user ON reading_sessions(user_id);
CREATE INDEX idx_reading_sessions_date ON reading_sessions(completed_at);

ALTER TABLE reading_sessions ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can manage own sessions" ON reading_sessions
  FOR ALL USING (auth.uid() = user_id);
```

### 2. API Endpoint
- [ ] `POST /api/sync/sessions` - Submit completed sessions
- [ ] `GET /api/sync/sessions` - Fetch session history (paginated)

### 3. Extension Integration
- [ ] On session complete: POST to server (if Pro)
- [ ] Store session ID to avoid duplicates
- [ ] Queue if offline, sync when online

## Acceptance Criteria

- [ ] Completed sessions appear on web dashboard
- [ ] Sessions include: URL, title, WPM, duration, word count
- [ ] No duplicate sessions
- [ ] Works with intermittent connectivity
