# Task 4.4: AI Adaptive Music (Stretch)

**Status:** pending  
**Phase:** 4 - Audio Features  
**Depends on:** Tasks 4.1, 3.1  
**Estimated Time:** 60 minutes

## Goal

Background music that adapts to article mood and reading speed.

## Overview

This is a stretch goal / nice-to-have feature.

## Options

### Option A: Mood-Based Track Selection
Use AI summarization to detect mood, then select matching static track.

```typescript
// Map mood to track category
const MOOD_TO_CATEGORY = {
  'energetic': 'upbeat',
  'serious': 'ambient',
  'calm': 'nature',
  'urgent': 'focus',
  'playful': 'lofi',
  'technical': 'minimal',
};
```

**Pros:** Simple, no extra API costs
**Cons:** Limited variety

### Option B: AI-Generated Music
Use Suno API or ElevenLabs (if available) to generate custom music.

```typescript
const prompt = `Generate ambient background music:
- Mood: ${articleMood}
- Tempo: ${bpm} BPM (based on WPM)
- Style: Minimal, non-distracting, instrumental
- Duration: 3 minutes, loop-friendly`;
```

**Pros:** Truly adaptive, unique
**Cons:** API costs, generation time, complexity

## Implementation (Option A)

### 1. Mood Detection
- [ ] Add `mood` field to summarization response
- [ ] Or use separate lightweight classification

### 2. Track Mapping
- [ ] Create mood → category mapping
- [ ] Select random track from category
- [ ] Consider tempo matching (WPM → BPM)

### 3. UI Toggle
- [ ] "Adaptive Music" toggle in settings
- [ ] Shows current mood/selection

## Implementation (Option B - Future)

### 1. Music Generation API
- [ ] Research Suno, ElevenLabs, or alternatives
- [ ] Create `/api/music/generate` endpoint
- [ ] Cache generated tracks

### 2. Tempo Sync
- [ ] Map WPM to BPM (e.g., 400 WPM → 100 BPM)
- [ ] Adjust playback rate dynamically

## Acceptance Criteria

- [ ] Music matches article mood (subjectively)
- [ ] Smooth transitions between tracks
- [ ] User can disable adaptive mode
- [ ] Falls back to static tracks if needed

## Notes

- Start with Option A (mood-based selection)
- Option B can be future enhancement
- Consider user preference override
