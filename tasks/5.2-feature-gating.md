# Task 5.2: Premium Feature Gating

**Status:** pending  
**Phase:** 5 - Polish & Launch  
**Depends on:** All premium feature tasks  
**Estimated Time:** 20 minutes

## Goal

Ensure all premium features are properly gated.

## Features to Gate

| Feature | Gate Location |
|---------|---------------|
| Cross-device sync | Extension + API |
| Web dashboard | Website middleware |
| Analytics charts | Dashboard page |
| Goals & streaks | Dashboard + Extension |
| AI summarization | Extension + API |
| TTS voice | Extension + API |
| Background music | Extension |
| Reading progress sync | Extension + API |

## Implementation

### 1. Extension Gating
```typescript
function requirePro(feature: string): boolean {
  if (!isPro) {
    showUpgradePrompt(feature);
    return false;
  }
  return true;
}

// Usage
if (!requirePro('AI Voice Narration')) return;
```

### 2. API Gating
```typescript
// Middleware for Pro-only endpoints
async function requireProUser(req: Request) {
  const user = await getUser(req);
  if (user.subscription_status === 'free') {
    return Response.json(
      { error: 'Pro subscription required' },
      { status: 403 }
    );
  }
}
```

### 3. Dashboard Gating
- [ ] Redirect free users to upgrade page
- [ ] Or show limited dashboard with upgrade prompts

### 4. Upgrade Prompts
Consistent design for upgrade prompts:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”’ Pro Feature                     â”‚
â”‚                                     â”‚
â”‚  [Feature Name] is available with   â”‚
â”‚  FlashRead Pro.                     â”‚
â”‚                                     â”‚
â”‚  â€¢ Benefit 1                        â”‚
â”‚  â€¢ Benefit 2                        â”‚
â”‚  â€¢ Benefit 3                        â”‚
â”‚                                     â”‚
â”‚  [Maybe Later]  [Upgrade to Pro]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. Subscription Expiration
- [ ] Check expiration date for subscriptions
- [ ] Grace period (3 days?) after expiration
- [ ] Downgrade to free after grace period
- [ ] Notify user before expiration

## Acceptance Criteria

- [ ] All Pro features check subscription status
- [ ] Free users see upgrade prompts, not errors
- [ ] Expired subscriptions handled gracefully
- [ ] No way to bypass gating
