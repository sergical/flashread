# Task 3.1: AI Summarization API

**Status:** pending  
**Phase:** 3 - AI Summarization  
**Depends on:** Task 1.7  
**Estimated Time:** 30 minutes

## Goal

Create backend API for AI-powered article summarization.

## Steps

### 1. OpenAI Setup
- [ ] Get OpenAI API key
- [ ] Add to `.env`:
  ```
  OPENAI_API_KEY=sk-...
  ```
- [ ] Install `openai` package

### 2. API Endpoint
- [ ] Create `POST /api/ai/summarize`

```typescript
// Request
{
  text: string,      // Article text (max ~10k tokens)
  url?: string,      // For caching
}

// Response
{
  tldr: string,           // 2-3 sentences
  keyPoints: string[],    // 3-5 bullet points
  difficulty: 'easy' | 'medium' | 'hard',
  topics: string[],       // 2-4 tags
  estimatedReadTime: number, // minutes at user's WPM
}
```

### 3. Prompt Engineering
```typescript
const prompt = `Analyze this article and provide a JSON response with:
1. "tldr": A 2-3 sentence summary capturing the main point
2. "keyPoints": Array of 3-5 key takeaways as concise bullet points
3. "difficulty": Reading difficulty ("easy", "medium", or "hard") based on vocabulary and concepts
4. "topics": Array of 2-4 topic tags

Article:
${text}

Respond with valid JSON only.`;
```

### 4. Rate Limiting
- [ ] Check `isPro` before processing
- [ ] Track usage per user (optional soft limit)
- [ ] Return 403 for free users

### 5. Caching (Optional)
- [ ] Cache by URL hash
- [ ] TTL: 7 days
- [ ] Avoids re-processing same articles

## Acceptance Criteria

- [ ] API returns accurate summaries
- [ ] Response time < 5 seconds
- [ ] Only Pro users can access
- [ ] Handles long articles gracefully (truncate if needed)

## Cost Estimate

- GPT-4o-mini: ~$0.15/1M input tokens
- Average article: ~5k tokens = ~$0.001/article
- Very affordable at scale
